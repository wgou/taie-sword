import{u as S}from"./useView.b2a319db.js";import{_ as E,b as I}from"./index.bc4fd47c.js";import{d as $,a as B,e as k,a0 as R,O as h,r,y as L,t as C,A as N,F as a,G as o,I as n,H as d,P as z,z as T,u as A,f as U,B as D}from"./vlib.73c86f1d.js";import"./lodash.58534d7e.js";import"./monacoeditor.d62c48b5.js";import"./lib.e5e0e84e.js";const H=$({props:{deviceId:{type:String,default:""}},setup(e){const t=B({post:!0,getDataListURL:"/installApp/list",getDataListIsPage:!0,dataForm:{deviceId:e.deviceId||"",packageName:"",remark:""}}),m=k(!1),p=k(""),g=k(!1),f=k(null);return{...S(t),...R(t),remarkDialogVisible:m,remarkText:p,remarkSubmitting:g,currentRow:f}},mounted(){this.deviceId&&(this.dataForm.deviceId=this.deviceId,this.getDataList())},methods:{formatDateTime(e){if(!e)return"";const t=new Date(e);if(isNaN(t.getTime()))return"";const m=t.getFullYear(),p=String(t.getMonth()+1).padStart(2,"0"),g=String(t.getDate()).padStart(2,"0"),f=String(t.getHours()).padStart(2,"0"),u=String(t.getMinutes()).padStart(2,"0"),i=String(t.getSeconds()).padStart(2,"0");return`${m}-${p}-${g} ${f}:${u}:${i}`},openRemarkDialog(e){this.currentRow=e,this.remarkText=e.remark||"",this.remarkDialogVisible=!0},async submitRemark(){if(!!this.currentRow){this.remarkSubmitting=!0;try{const{code:e,msg:t}=await I.post("/installApp/addRemark",{id:this.currentRow.id,remark:this.remarkText||""});e==0?(h({message:"\u64CD\u4F5C\u6210\u529F",type:"success"}),this.remarkDialogVisible=!1,this.getDataList()):h({message:t||"\u64CD\u4F5C\u5931\u8D25",type:"error"})}catch{h({message:"\u64CD\u4F5C\u5931\u8D25",type:"error"})}finally{this.remarkSubmitting=!1}}}}}),M={class:"mod-install-app__list"},j={style:{"margin-top":"16px"}};function K(e,t,m,p,g,f){const u=r("el-input"),i=r("el-form-item"),c=r("el-button"),v=r("el-form"),s=r("el-table-column"),w=r("el-table"),_=r("el-pagination"),b=r("el-descriptions-item"),F=r("el-descriptions"),V=r("el-dialog"),y=L("loading");return C(),N("div",M,[a(v,{inline:!0,model:e.dataForm,onKeyup:t[4]||(t[4]=z(l=>e.getDataList(),["enter"]))},{default:o(()=>[a(i,null,{default:o(()=>[a(u,{modelValue:e.dataForm.deviceId,"onUpdate:modelValue":t[0]||(t[0]=l=>e.dataForm.deviceId=l),placeholder:"\u8BBE\u5907ID",clearable:""},null,8,["modelValue"])]),_:1}),a(i,null,{default:o(()=>[a(u,{modelValue:e.dataForm.packageName,"onUpdate:modelValue":t[1]||(t[1]=l=>e.dataForm.packageName=l),placeholder:"\u5E94\u7528\u5305\u540D",clearable:""},null,8,["modelValue"])]),_:1}),a(i,null,{default:o(()=>[a(u,{modelValue:e.dataForm.remark,"onUpdate:modelValue":t[2]||(t[2]=l=>e.dataForm.remark=l),placeholder:"\u5907\u6CE8",clearable:""},null,8,["modelValue"])]),_:1}),a(i,null,{default:o(()=>[a(c,{onClick:t[3]||(t[3]=l=>e.getDataList())},{default:o(()=>[n(d(e.$t("query")),1)]),_:1})]),_:1})]),_:1},8,["model"]),T((C(),A(w,{data:e.dataList,border:"",onSortChange:e.dataListSortChangeHandle,"table-layout":"auto",style:{width:"100%"}},{default:o(()=>[a(s,{prop:"deviceId",label:"\u8BBE\u5907ID","header-align":"center",align:"center",width:"200px","show-overflow-tooltip":""}),a(s,{prop:"pkg",label:"\u6240\u5C5E\u5305","header-align":"center",align:"center",width:"200px","show-overflow-tooltip":""}),a(s,{prop:"packageName",label:"\u5E94\u7528\u5305\u540D","header-align":"center",align:"center","min-width":"250px","show-overflow-tooltip":""}),a(s,{prop:"remark",label:"\u5907\u6CE8","header-align":"center",align:"center","min-width":"200px","show-overflow-tooltip":""}),a(s,{prop:"created",label:"\u6700\u65B0\u4E0A\u4F20\u65F6\u95F4","header-align":"center",align:"center",width:"180px",sortable:"custom"},{default:o(l=>[n(d(e.formatDateTime(l.row.created)),1)]),_:1}),a(s,{label:e.$t("handle"),"header-align":"center",align:"center",width:"100px",fixed:"right"},{default:o(l=>[a(c,{link:"",type:"primary",onClick:P=>e.openRemarkDialog(l.row)},{default:o(()=>t[8]||(t[8]=[n("\u5907\u6CE8")])),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data","onSortChange"])),[[y,e.dataListLoading]]),a(_,{"current-page":e.page,"page-sizes":[10,20,50,100],"page-size":e.limit,total:e.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:e.pageSizeChangeHandle,onCurrentChange:e.pageCurrentChangeHandle},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"]),U(" \u5907\u6CE8\u5F39\u7A97 "),a(V,{modelValue:e.remarkDialogVisible,"onUpdate:modelValue":t[7]||(t[7]=l=>e.remarkDialogVisible=l),title:"\u6DFB\u52A0\u5907\u6CE8",width:"500px","close-on-click-modal":!1},{footer:o(()=>[a(c,{onClick:t[6]||(t[6]=l=>e.remarkDialogVisible=!1)},{default:o(()=>t[9]||(t[9]=[n("\u53D6\u6D88")])),_:1}),a(c,{type:"primary",onClick:e.submitRemark,loading:e.remarkSubmitting},{default:o(()=>t[10]||(t[10]=[n("\u786E\u5B9A")])),_:1},8,["onClick","loading"])]),default:o(()=>[D("div",null,[a(F,{column:1,border:"",size:"small",title:"\u5E94\u7528\u4FE1\u606F"},{default:o(()=>[a(b,{label:"\u8BBE\u5907ID"},{default:o(()=>{var l;return[n(d((l=e.currentRow)==null?void 0:l.deviceId),1)]}),_:1}),a(b,{label:"\u6240\u5C5E\u5305"},{default:o(()=>{var l;return[n(d((l=e.currentRow)==null?void 0:l.pkg),1)]}),_:1}),a(b,{label:"\u5E94\u7528\u5305\u540D"},{default:o(()=>{var l;return[n(d((l=e.currentRow)==null?void 0:l.packageName),1)]}),_:1})]),_:1})]),D("div",j,[a(v,{"label-width":"80px"},{default:o(()=>[a(i,{label:"\u5907\u6CE8"},{default:o(()=>[a(u,{modelValue:e.remarkText,"onUpdate:modelValue":t[5]||(t[5]=l=>e.remarkText=l),type:"textarea",rows:4,placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8\u4FE1\u606F",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})])]),_:1},8,["modelValue"])])}var W=E(H,[["render",K],["__scopeId","data-v-43f6fff1"],["__file","/Users/luochen/project17/taie-sword/taie-admin-vue/src/views/apps/list.vue"]]);export{W as default};
