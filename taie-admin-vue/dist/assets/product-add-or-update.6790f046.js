import{d as $,a as F,r as s,t as C,u as E,F as o,E as a,H as l,G as b,O as D}from"./vlib.0bb5c6cc.js";import{_ as k,u as w,b as n}from"./index.d126106f.js";import"./monacoeditor.d62c48b5.js";import"./lodash.8cc0d8b0.js";import"./lib.aa75605a.js";const V=$({setup(){return F({visible:!1,tableData:[],dataForm:{id:"",name:"",content:"",subList:[]}})},computed:{dataRule(){return{name:[{required:!0,message:this.$t("validate.required"),trigger:"blur"}],content:[{required:!0,message:this.$t("validate.required"),trigger:"blur"}],updater:[{required:!0,message:this.$t("validate.required"),trigger:"blur"}],updateDate:[{required:!0,message:this.$t("validate.required"),trigger:"blur"}]}}},created(){this.dataFormSubmitHandle=w(this.dataFormSubmitHandle)},methods:{init(){this.visible=!0,this.$nextTick(()=>{this.$refs.dataFormRef.resetFields(),this.tableData=[],this.dataForm.id&&this.getInfo()})},async insertEvent(e){let t={num:"1"},{row:u}=await this.$refs.xTable.insertAt(t,e);await this.$refs.xTable.setActiveCell(u,"paramName")},removeEvent(){this.$refs.xTable.getCheckboxRecords().length?this.$refs.xTable.removeCheckboxRow():this.$message.error("\u8BF7\u81F3\u5C11\u9009\u62E9\u4E00\u6761\u6570\u636E")},getInfo(){n.get(`/demo/product/${this.dataForm.id}`).then(e=>{if(e.code!==0)return this.$message.error(e.msg);this.dataForm={...this.dataForm,...e.data},this.tableData=e.data.subList})},dataFormSubmitHandle(){this.$refs.dataFormRef.validate(e=>{if(!e)return!1;this.dataForm.subList=this.$refs.xTable.getTableData().tableData,(this.dataForm.id?n.put:n.post)("/demo/product/",this.dataForm).then(t=>{if(t.code!==0)return this.$message.error(t.msg);this.$message({message:this.$t("prompt.success"),type:"success",duration:500,onClose:()=>{this.visible=!1,this.$emit("refreshDataList")}})})})}}});function _(e,t,u,R,y,T){const d=s("el-input"),m=s("el-form-item"),c=s("el-form"),p=s("vxe-button"),v=s("vxe-toolbar"),i=s("vxe-column"),h=s("vxe-table"),f=s("el-button"),g=s("el-dialog");return C(),E(g,{modelValue:e.visible,"onUpdate:modelValue":t[6]||(t[6]=r=>e.visible=r),title:e.dataForm.id?e.$t("update"):e.$t("add"),"close-on-click-modal":!1,"close-on-press-escape":!1},{footer:o(()=>[a(f,{onClick:t[4]||(t[4]=r=>e.visible=!1)},{default:o(()=>[l(b(e.$t("cancel")),1)]),_:1}),a(f,{type:"primary",onClick:t[5]||(t[5]=r=>e.dataFormSubmitHandle())},{default:o(()=>[l(b(e.$t("confirm")),1)]),_:1})]),default:o(()=>[a(c,{model:e.dataForm,rules:e.dataRule,ref:"dataFormRef",onKeyup:t[2]||(t[2]=D(r=>e.dataFormSubmitHandle(),["enter"])),"label-width":e.$i18n.locale==="en-US"?"120px":"80px"},{default:o(()=>[a(m,{label:"\u4EA7\u54C1\u540D\u79F0",prop:"name"},{default:o(()=>[a(d,{modelValue:e.dataForm.name,"onUpdate:modelValue":t[0]||(t[0]=r=>e.dataForm.name=r),placeholder:"\u4EA7\u54C1\u540D\u79F0"},null,8,["modelValue"])]),_:1}),a(m,{label:"\u4EA7\u54C1\u4ECB\u7ECD",prop:"content"},{default:o(()=>[a(d,{modelValue:e.dataForm.content,"onUpdate:modelValue":t[1]||(t[1]=r=>e.dataForm.content=r),placeholder:"\u4EA7\u54C1\u4ECB\u7ECD"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules","label-width"]),a(v,{perfect:""},{buttons:o(()=>[a(p,{icon:"fa fa-plus",status:"perfect",onClick:t[3]||(t[3]=r=>e.insertEvent(-1))},{default:o(()=>t[7]||(t[7]=[l("\u65B0\u589E")])),_:1}),a(p,{icon:"fa fa-trash-o",status:"perfect",onClick:e.removeEvent},{default:o(()=>t[8]||(t[8]=[l("\u5220\u9664")])),_:1},8,["onClick"])]),_:1}),a(h,{border:"","show-overflow":"",ref:"xTable",class:"my_table_insert","max-height":"400",data:e.tableData,"edit-config":{trigger:"click",mode:"cell",icon:"fa fa-pencil"}},{default:o(()=>[a(i,{type:"checkbox",width:"60"}),a(i,{field:"paramName",title:"\u53C2\u6570\u540D",sortable:"","edit-render":{name:"input",defaultValue:""}}),a(i,{field:"paramValue",title:"\u53C2\u6570\u503C","edit-render":{name:"input"}})]),_:1},8,["data"])]),_:1},8,["modelValue","title"])}var H=k(V,[["render",_]]);export{H as default};
