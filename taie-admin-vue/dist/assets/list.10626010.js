import{u as y}from"./useView.504fb702.js";import{d as L,a as D,$,r as o,y as F,t as l,A as c,E as n,F as i,H as _,G as h,O as z,z as B,u as f}from"./vlib.982cfaee.js";import{_ as E}from"./index.8146017f.js";import"./monacoeditor.d62c48b5.js";import"./lodash.0b661716.js";import"./lib.b62e57c8.js";const k=L({props:{deviceId:{type:String,default:""}},setup(e){const t=D({post:!0,getDataListURL:"/album/page",getDataListIsPage:!0,dataForm:{deviceId:e.deviceId||""}});return{...y(t),...$(t)}},mounted(){this.deviceId&&(this.dataForm.deviceId=this.deviceId,this.getDataList())},computed:{imageList(){return this.dataList.filter(e=>e.imgPath).map(e=>e.imgPath)}},methods:{formatDateTime(e){if(!e)return"";const t=new Date(e);if(isNaN(t.getTime()))return"";const u=t.getFullYear(),p=String(t.getMonth()+1).padStart(2,"0"),m=String(t.getDate()).padStart(2,"0"),g=String(t.getHours()).padStart(2,"0"),s=String(t.getMinutes()).padStart(2,"0"),r=String(t.getSeconds()).padStart(2,"0");return`${u}-${p}-${m} ${g}:${s}:${r}`},getImageIndex(e){return this.imageList.findIndex(t=>t===e)}}}),P={class:"mod-album__list"},V={key:1};function H(e,t,u,p,m,g){const s=o("el-input"),r=o("el-form-item"),v=o("el-button"),b=o("el-form"),d=o("el-table-column"),S=o("el-image"),w=o("el-table"),I=o("el-pagination"),C=F("loading");return l(),c("div",P,[n(b,{inline:!0,model:e.dataForm,onKeyup:t[2]||(t[2]=z(a=>e.getDataList(),["enter"]))},{default:i(()=>[n(r,null,{default:i(()=>[n(s,{modelValue:e.dataForm.deviceId,"onUpdate:modelValue":t[0]||(t[0]=a=>e.dataForm.deviceId=a),placeholder:"\u8BBE\u5907ID",clearable:""},null,8,["modelValue"])]),_:1}),n(r,null,{default:i(()=>[n(v,{onClick:t[1]||(t[1]=a=>e.getDataList())},{default:i(()=>[_(h(e.$t("query")),1)]),_:1})]),_:1})]),_:1},8,["model"]),B((l(),f(w,{data:e.dataList,border:"",onSortChange:e.dataListSortChangeHandle,"table-layout":"auto",style:{width:"100%"}},{default:i(()=>[n(d,{prop:"deviceId",label:"\u8BBE\u5907ID","header-align":"center",align:"center",width:"200px","show-overflow-tooltip":""}),n(d,{label:"\u56FE\u7247\u9884\u89C8","header-align":"center",align:"center"},{default:i(a=>[a.row.imgPath?(l(),f(S,{key:0,src:a.row.imgPath,"preview-src-list":e.imageList,"initial-index":e.getImageIndex(a.row.imgPath),fit:"cover",style:{width:"100px",height:"100px",cursor:"pointer"},"hide-on-click-modal":!0,"preview-teleported":!0},null,8,["src","preview-src-list","initial-index"])):(l(),c("span",V,"\u65E0\u56FE\u7247"))]),_:1}),n(d,{prop:"created",label:"\u521B\u5EFA\u65F6\u95F4","header-align":"center",align:"center",width:"200px",sortable:"custom"},{default:i(a=>[_(h(e.formatDateTime(a.row.created)),1)]),_:1})]),_:1},8,["data","onSortChange"])),[[C,e.dataListLoading]]),n(I,{"current-page":e.page,"page-sizes":[10,20,50,100],"page-size":e.limit,total:e.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:e.pageSizeChangeHandle,onCurrentChange:e.pageCurrentChangeHandle},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])}var U=E(k,[["render",H],["__scopeId","data-v-16c3b718"]]);export{U as default};
