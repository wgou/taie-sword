import{_ as c,a as m,g as f}from"./index.6b1e63f3.js";import{d as g,a as _,r as s,t as h,u as $,F as t,E as i,B as l,G as v}from"./vlib.0bb5c6cc.js";import"./lodash.8cc0d8b0.js";import"./monacoeditor.d62c48b5.js";import"./lib.aa75605a.js";const b=g({setup(){return _({visible:!1,url:"",num:0,fileList:[]})},methods:{init(){this.visible=!0,this.url=`${m.api}/sys/oss/upload?token=${f()}`,this.num=0,this.fileList=[]},beforeUploadHandle(e){if(e.type!=="image/jpg"&&e.type!=="image/jpeg"&&e.type!=="image/png"&&e.type!=="image/gif")return this.$message.error(this.$t("upload.tip",{format:"jpg\u3001png\u3001gif"})),!1;this.num++},successHandle(e,o,a){if(e.code!==0)return this.$message.error(e.msg);this.fileList=a,this.num--,this.num===0&&this.$message({message:this.$t("prompt.success"),type:"success",duration:500,onClose:()=>{this.visible=!1,this.$emit("refreshDataList")}})}}}),y=["innerHTML"],L={class:"el-upload__tip"};function H(e,o,a,k,V,j){const n=s("upload-filled"),p=s("el-icon"),r=s("el-upload"),u=s("el-dialog");return h(),$(u,{modelValue:e.visible,"onUpdate:modelValue":o[0]||(o[0]=d=>e.visible=d),title:e.$t("oss.upload"),"close-on-click-modal":!1,"close-on-press-escape":!1},{default:t(()=>[i(r,{action:e.url,"file-list":e.fileList,drag:"",multiple:"","before-upload":e.beforeUploadHandle,"on-success":e.successHandle,class:"text-center"},{tip:t(()=>[l("div",L,v(e.$t("upload.tip",{format:"jpg\u3001png\u3001gif"})),1)]),default:t(()=>[i(p,{class:"el-icon--upload"},{default:t(()=>[i(n)]),_:1}),l("div",{class:"el-upload__text",innerHTML:e.$t("upload.text")},null,8,y)]),_:1},8,["action","file-list","before-upload","on-success"])]),_:1},8,["modelValue","title"])}var M=c(b,[["render",H]]);export{M as default};
