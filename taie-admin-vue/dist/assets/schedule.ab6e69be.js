import{u as S}from"./useView.b2a319db.js";import{d as w,a as H,a0 as B,r as h,y as D,t as l,A as P,F as a,G as s,I as o,H as u,u as i,f as r,P as V,z}from"./vlib.73c86f1d.js";import{_ as F,b as c}from"./index.bc4fd47c.js";import N from"./schedule-add-or-update.6adc3e36.js";import U from"./schedule-log.9ad38220.js";import"./monacoeditor.d62c48b5.js";import"./lodash.58534d7e.js";import"./lib.e5e0e84e.js";const T=w({components:{AddOrUpdate:N,Log:U},setup(){const e=H({getDataListURL:"/sys/schedule/page",getDataListIsPage:!0,deleteURL:"/sys/schedule",deleteIsBatch:!0,dataForm:{beanName:""},logVisible:!1});return{...S(e),...B(e)}},methods:{pauseHandle(e){if(!e&&this.dataListSelections&&this.dataListSelections.length<=0)return this.$message({message:this.$t("prompt.deleteBatch"),type:"warning",duration:500});this.$confirm(this.$t("prompt.info",{handle:this.$t("schedule.pause")}),this.$t("prompt.title"),{confirmButtonText:this.$t("confirm"),cancelButtonText:this.$t("cancel"),type:"warning"}).then(()=>{c.put("/sys/schedule/pause",e?[e]:this.dataListSelections&&this.dataListSelections.map(t=>t.id)).then(t=>{if(t.code!==0)return this.$message.error(t.msg);this.$message({message:this.$t("prompt.success"),type:"success",duration:500,onClose:()=>{this.getDataList()}})})}).catch(()=>{})},resumeHandle(e){if(!e&&this.dataListSelections&&this.dataListSelections.length<=0)return this.$message({message:this.$t("prompt.deleteBatch"),type:"warning",duration:500});this.$confirm(this.$t("prompt.info",{handle:this.$t("schedule.resume")}),this.$t("prompt.title"),{confirmButtonText:this.$t("confirm"),cancelButtonText:this.$t("cancel"),type:"warning"}).then(()=>{c.put("/sys/schedule/resume",e?[e]:this.dataListSelections&&this.dataListSelections.map(t=>t.id)).then(t=>{if(t.code!==0)return this.$message.error(t.msg);this.$message({message:this.$t("prompt.success"),type:"success",duration:500,onClose:()=>{this.getDataList()}})})}).catch(()=>{})},runHandle(e){if(!e&&this.dataListSelections&&this.dataListSelections.length<=0)return this.$message({message:this.$t("prompt.deleteBatch"),type:"warning",duration:500});this.$confirm(this.$t("prompt.info",{handle:this.$t("schedule.run")}),this.$t("prompt.title"),{confirmButtonText:this.$t("confirm"),cancelButtonText:this.$t("cancel"),type:"warning"}).then(()=>{c.put("/sys/schedule/run",e?[e]:this.dataListSelections&&this.dataListSelections.map(t=>t.id)).then(t=>{if(t.code!==0)return this.$message.error(t.msg);this.$message({message:this.$t("prompt.success"),type:"success",duration:500,onClose:()=>{this.getDataList()}})})}).catch(()=>{})},logHandle(){this.logVisible=!0,this.$nextTick(()=>{this.$refs.log.init()})}}}),E={class:"mod-job__schedule"};function O(e,t,R,j,A,I){const $=h("el-input"),p=h("el-form-item"),d=h("el-button"),y=h("el-form"),m=h("el-table-column"),f=h("el-tag"),k=h("el-table"),v=h("el-pagination"),C=h("add-or-update"),b=h("log"),L=D("loading");return l(),P("div",E,[a(y,{inline:!0,model:e.dataForm,onKeyup:t[8]||(t[8]=V(n=>e.getDataList(),["enter"]))},{default:s(()=>[a(p,null,{default:s(()=>[a($,{modelValue:e.dataForm.beanName,"onUpdate:modelValue":t[0]||(t[0]=n=>e.dataForm.beanName=n),placeholder:e.$t("schedule.beanName"),clearable:""},null,8,["modelValue","placeholder"])]),_:1}),a(p,null,{default:s(()=>[a(d,{onClick:t[1]||(t[1]=n=>e.getDataList())},{default:s(()=>[o(u(e.$t("query")),1)]),_:1})]),_:1}),a(p,null,{default:s(()=>[e.hasPermission("sys:schedule:save")?(l(),i(d,{key:0,type:"primary",onClick:t[2]||(t[2]=n=>e.addOrUpdateHandle())},{default:s(()=>[o(u(e.$t("add")),1)]),_:1})):r("v-if",!0)]),_:1}),a(p,null,{default:s(()=>[e.hasPermission("sys:schedule:delete")?(l(),i(d,{key:0,type:"danger",onClick:t[3]||(t[3]=n=>e.deleteHandle())},{default:s(()=>[o(u(e.$t("deleteBatch")),1)]),_:1})):r("v-if",!0)]),_:1}),a(p,null,{default:s(()=>[e.hasPermission("sys:schedule:pause")?(l(),i(d,{key:0,type:"danger",onClick:t[4]||(t[4]=n=>e.pauseHandle())},{default:s(()=>[o(u(e.$t("schedule.pauseBatch")),1)]),_:1})):r("v-if",!0)]),_:1}),a(p,null,{default:s(()=>[e.hasPermission("sys:schedule:resume")?(l(),i(d,{key:0,type:"danger",onClick:t[5]||(t[5]=n=>e.resumeHandle())},{default:s(()=>[o(u(e.$t("schedule.resumeBatch")),1)]),_:1})):r("v-if",!0)]),_:1}),a(p,null,{default:s(()=>[e.hasPermission("sys:schedule:run")?(l(),i(d,{key:0,type:"danger",onClick:t[6]||(t[6]=n=>e.runHandle())},{default:s(()=>[o(u(e.$t("schedule.runBatch")),1)]),_:1})):r("v-if",!0)]),_:1}),a(p,null,{default:s(()=>[e.hasPermission("sys:schedule:log")?(l(),i(d,{key:0,type:"success",onClick:t[7]||(t[7]=n=>e.logHandle())},{default:s(()=>[o(u(e.$t("schedule.log")),1)]),_:1})):r("v-if",!0)]),_:1})]),_:1},8,["model"]),z((l(),i(k,{data:e.dataList,border:"",onSelectionChange:e.dataListSelectionChangeHandle,onSortChange:e.dataListSortChangeHandle,style:{width:"100%"}},{default:s(()=>[a(m,{type:"selection","header-align":"center",align:"center",width:"50"}),a(m,{prop:"beanName",label:e.$t("schedule.beanName"),"header-align":"center",align:"center"},null,8,["label"]),a(m,{prop:"params",label:e.$t("schedule.params"),"header-align":"center",align:"center"},null,8,["label"]),a(m,{prop:"cronExpression",label:e.$t("schedule.cronExpression"),"header-align":"center",align:"center"},null,8,["label"]),a(m,{prop:"remark",label:e.$t("schedule.remark"),"header-align":"center",align:"center"},null,8,["label"]),a(m,{prop:"status",label:e.$t("schedule.status"),sortable:"custom","header-align":"center",align:"center"},{default:s(n=>[n.row.status===1?(l(),i(f,{key:0,size:"small"},{default:s(()=>[o(u(e.$t("schedule.status1")),1)]),_:1})):(l(),i(f,{key:1,size:"small",type:"danger"},{default:s(()=>[o(u(e.$t("schedule.status0")),1)]),_:1}))]),_:1},8,["label"]),a(m,{label:e.$t("handle"),fixed:"right","header-align":"center",align:"center",width:"248"},{default:s(n=>[e.hasPermission("sys:schedule:update")?(l(),i(d,{key:0,type:"primary",link:"",onClick:g=>e.addOrUpdateHandle(n.row.id)},{default:s(()=>[o(u(e.$t("update")),1)]),_:2},1032,["onClick"])):r("v-if",!0),e.hasPermission("sys:schedule:pause")?(l(),i(d,{key:1,type:"primary",link:"",onClick:g=>e.pauseHandle(n.row.id)},{default:s(()=>[o(u(e.$t("schedule.pause")),1)]),_:2},1032,["onClick"])):r("v-if",!0),e.hasPermission("sys:schedule:resume")?(l(),i(d,{key:2,type:"primary",link:"",onClick:g=>e.resumeHandle(n.row.id)},{default:s(()=>[o(u(e.$t("schedule.resume")),1)]),_:2},1032,["onClick"])):r("v-if",!0),e.hasPermission("sys:schedule:run")?(l(),i(d,{key:3,type:"primary",link:"",onClick:g=>e.runHandle(n.row.id)},{default:s(()=>[o(u(e.$t("schedule.run")),1)]),_:2},1032,["onClick"])):r("v-if",!0),e.hasPermission("sys:schedule:delete")?(l(),i(d,{key:4,type:"primary",link:"",onClick:g=>e.deleteHandle(n.row.id)},{default:s(()=>[o(u(e.$t("delete")),1)]),_:2},1032,["onClick"])):r("v-if",!0)]),_:1},8,["label"])]),_:1},8,["data","onSelectionChange","onSortChange"])),[[L,e.dataListLoading]]),a(v,{"current-page":e.page,"page-sizes":[10,20,50,100],"page-size":e.limit,total:e.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:e.pageSizeChangeHandle,onCurrentChange:e.pageCurrentChangeHandle},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"]),r(" \u5F39\u7A97, \u65B0\u589E / \u4FEE\u6539 "),e.addOrUpdateVisible?(l(),i(C,{key:0,ref:"addOrUpdate",onRefreshDataList:e.getDataList},null,8,["onRefreshDataList"])):r("v-if",!0),r(" \u5F39\u7A97, \u65E5\u5FD7\u5217\u8868 "),e.logVisible?(l(),i(b,{key:1,ref:"log"},null,512)):r("v-if",!0)])}var Y=F(T,[["render",O],["__file","/Users/luochen/project17/taie-sword/taie-admin-vue/src/views/job/schedule.vue"]]);export{Y as default};
