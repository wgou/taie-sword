import{d as c,a as m,r as s,t as f,u as g,G as t,F as i,B as l,H as _}from"./vlib.73c86f1d.js";import{_ as h,c as $,g as v}from"./index.bc4fd47c.js";import"./monacoeditor.d62c48b5.js";import"./lodash.58534d7e.js";import"./lib.e5e0e84e.js";const b=c({setup(){return m({visible:!1,url:"",num:0,fileList:[]})},methods:{init(){this.visible=!0,this.url=`${$.api}/sys/oss/upload?token=${v()}`,this.num=0,this.fileList=[]},beforeUploadHandle(e){if(e.type!=="image/jpg"&&e.type!=="image/jpeg"&&e.type!=="image/png"&&e.type!=="image/gif")return this.$message.error(this.$t("upload.tip",{format:"jpg\u3001png\u3001gif"})),!1;this.num++},successHandle(e,o,a){if(e.code!==0)return this.$message.error(e.msg);this.fileList=a,this.num--,this.num===0&&this.$message({message:this.$t("prompt.success"),type:"success",duration:500,onClose:()=>{this.visible=!1,this.$emit("refreshDataList")}})}}}),y=["innerHTML"],H={class:"el-upload__tip"};function L(e,o,a,j,k,U){const n=s("upload-filled"),p=s("el-icon"),r=s("el-upload"),u=s("el-dialog");return f(),g(u,{modelValue:e.visible,"onUpdate:modelValue":o[0]||(o[0]=d=>e.visible=d),title:e.$t("oss.upload"),"close-on-click-modal":!1,"close-on-press-escape":!1},{default:t(()=>[i(r,{action:e.url,"file-list":e.fileList,drag:"",multiple:"","before-upload":e.beforeUploadHandle,"on-success":e.successHandle,class:"text-center"},{tip:t(()=>[l("div",H,_(e.$t("upload.tip",{format:"jpg\u3001png\u3001gif"})),1)]),default:t(()=>[i(p,{class:"el-icon--upload"},{default:t(()=>[i(n)]),_:1}),l("div",{class:"el-upload__text",innerHTML:e.$t("upload.text")},null,8,y)]),_:1},8,["action","file-list","before-upload","on-success"])]),_:1},8,["modelValue","title"])}var D=h(b,[["render",L],["__file","/Users/luochen/project17/taie-sword/taie-admin-vue/src/views/oss/oss-upload.vue"]]);export{D as default};
