import{d as C,a as L,e as c,r as s,t as i,u,G as o,F as a,I as f,a6 as k,f as N,B as r,A as _,J as V,M as w,K as H}from"./vlib.73c86f1d.js";import{_ as D,j as B,n as S,b as h}from"./index.bc4fd47c.js";import"./monacoeditor.d62c48b5.js";import"./lodash.58534d7e.js";import"./lib.e5e0e84e.js";const T=C({setup(){return L({visible:!1,menuList:[],menuListPopover:c(),iconList:[],iconListPopover:c(),dataForm:{name:"",pid:"0",parentName:"",icon:"",moduleName:"",className:""}})},computed:{dataRule(){return{name:[{required:!0,message:this.$t("validate.required"),trigger:"blur"}],parentName:[{required:!0,message:this.$t("validate.required"),trigger:"change"}]}}},created(){this.dataFormSubmitHandle=B(this.dataFormSubmitHandle)},methods:{init(){this.visible=!0,this.$nextTick(()=>{this.$refs.dataFormRef.resetFields(),this.iconList=S(),this.dataForm.parentName=this.$t("menu.parentNameDefault"),this.getMenuList()})},getMenuList(){return h.get("/sys/menu/list?type=0").then(e=>{if(e.code!==0)return this.$message.error(e.msg);this.menuList=e.data})},deptListTreeSetDefaultHandle(){this.dataForm.pid="0",this.dataForm.parentName=this.$t("menu.parentNameDefault")},menuListTreeCurrentChangeHandle(e){this.dataForm.pid=e.id,this.dataForm.parentName=e.name,this.menuListPopover.hide()},iconListCurrentChangeHandle(e){this.dataForm.icon=e,this.iconListPopover.hide()},dataFormSubmitHandle(){this.$refs.dataFormRef.validate(e=>{if(!e)return!1;h.post("/devtools/menu",this.dataForm).then(t=>{if(t.code!==0)return this.$message.error(t.msg);this.$message({message:this.$t("prompt.success"),type:"success",duration:500,onClose:()=>{this.visible=!1,this.$emit("refreshDataList")}})})})}}}),M={class:"popover-pop-body"},P={class:"mod-sys__menu-icon-inner"},R={class:"mod-sys__menu-icon-list"},U={class:"icon-svg","aria-hidden":"true"},q=["xlink:href"];function A(e,t,E,j,x,z){const v=s("el-tree"),g=s("circle-close"),b=s("el-icon"),l=s("el-input"),p=s("el-popover"),d=s("el-form-item"),m=s("el-button"),F=s("el-form"),y=s("el-dialog");return i(),u(y,{modelValue:e.visible,"onUpdate:modelValue":t[5]||(t[5]=n=>e.visible=n),title:"\u521B\u5EFA\u83DC\u5355","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:o(()=>[a(m,{onClick:t[4]||(t[4]=n=>e.visible=!1)},{default:o(()=>t[6]||(t[6]=[f("\u53D6\u6D88")])),_:1}),a(m,{type:"primary",onClick:e.dataFormSubmitHandle},{default:o(()=>t[7]||(t[7]=[f("\u786E\u5B9A")])),_:1},8,["onClick"])]),default:o(()=>[a(F,{model:e.dataForm,rules:e.dataRule,ref:"dataFormRef","label-width":"120px"},{default:o(()=>[a(d,{prop:"parentName",label:e.$t("menu.parentName"),class:"menu-list"},{default:o(()=>[a(p,{ref:"menuListPopover",width:400,placement:"bottom-start",trigger:"click","popper-class":"popover-pop"},{reference:o(()=>[a(l,{modelValue:e.dataForm.parentName,"onUpdate:modelValue":t[1]||(t[1]=n=>e.dataForm.parentName=n),readonly:!0,placeholder:e.$t("menu.parentName")},{suffix:o(()=>[e.dataForm.pid!=="0"?(i(),u(b,{key:0,class:"el-input__icon",onClick:t[0]||(t[0]=k(n=>e.deptListTreeSetDefaultHandle(),["stop"]))},{default:o(()=>[a(g)]),_:1})):N("v-if",!0)]),_:1},8,["modelValue","placeholder"])]),default:o(()=>[r("div",M,[a(v,{data:e.menuList,props:{label:"name",children:"children"},"node-key":"id",ref:"menuListTree","highlight-current":!0,"expand-on-click-node":!1,accordion:"",onCurrentChange:e.menuListTreeCurrentChangeHandle},null,8,["data","onCurrentChange"])])]),_:1},512)]),_:1},8,["label"]),a(d,{prop:"name",label:e.$t("menu.name")},{default:o(()=>[a(l,{modelValue:e.dataForm.name,"onUpdate:modelValue":t[2]||(t[2]=n=>e.dataForm.name=n),placeholder:e.$t("menu.name")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(d,{prop:"icon",label:e.$t("menu.icon"),class:"icon-list"},{default:o(()=>[a(p,{ref:"iconListPopover",placement:"bottom-start","popper-class":"popover-pop mod-sys__menu-icon-popover",trigger:"click"},{reference:o(()=>[a(l,{modelValue:e.dataForm.icon,"onUpdate:modelValue":t[3]||(t[3]=n=>e.dataForm.icon=n),readonly:!0,placeholder:e.$t("menu.icon")},null,8,["modelValue","placeholder"])]),default:o(()=>[r("div",P,[r("div",R,[(i(!0),_(H,null,V(e.iconList,(n,$)=>(i(),u(m,{key:$,onClick:G=>e.iconListCurrentChangeHandle(n),class:w({"is-active":e.dataForm.icon===n})},{default:o(()=>[(i(),_("svg",U,[r("use",{"xlink:href":`#${n}`},null,8,q)]))]),_:2},1032,["onClick","class"]))),128))])])]),_:1},512)]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}var W=D(T,[["render",A],["__file","/Users/luochen/project17/taie-sword/taie-admin-vue/src/views/devtools/generator-menu.vue"]]);export{W as default};
