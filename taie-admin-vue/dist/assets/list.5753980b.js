import{u as k}from"./useView.7a1c979e.js";import{d as S,a as b,e as D,a0 as w,O as i,W as O,r as n,y as $,t as C,A as L,F as a,G as r,I as p,H as F,P as A,z as B,u as _}from"./vlib.611ed292.js";import{_ as z,b as E}from"./index.a08d64ed.js";import"./monacoeditor.d62c48b5.js";import"./lodash.78aef77c.js";import"./lib.18273bf4.js";const I=S({setup(){const e=b({post:!0,getDataListURL:"/proxyInfo/page",getDataListIsPage:!0,dataForm:{pkg:"",proxyUser:""}}),t=D(!1),l=D(!1),d=D(),f=b({pkg:"",proxyUser:""}),y={pkg:[{required:!0,message:"\u5305\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],proxyUser:[{required:!0,message:"\u4EE3\u7406\u7528\u6237\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]};return{...k(e),...w(e),addOrUpdateVisible:t,submitLoading:l,dataFormRef:d,addOrUpdateForm:f,dataRule:y}},mounted(){this.getDataList()},methods:{formatDateTime(e){if(!e)return"";const t=new Date(e);if(isNaN(t.getTime()))return"";const l=t.getFullYear(),d=String(t.getMonth()+1).padStart(2,"0"),f=String(t.getDate()).padStart(2,"0"),y=String(t.getHours()).padStart(2,"0"),s=String(t.getMinutes()).padStart(2,"0"),u=String(t.getSeconds()).padStart(2,"0");return`${l}-${d}-${f} ${y}:${s}:${u}`},openAddOrUpdateDialog(){this.addOrUpdateVisible=!0,this.addOrUpdateForm.pkg="",this.addOrUpdateForm.proxyUser=""},async dataFormSubmit(){var e;(e=this.dataFormRef)==null||e.validate(async t=>{if(!t)return!1;this.submitLoading=!0;try{const{code:l,msg:d}=await E.post("/proxyInfo/save",{pkg:this.addOrUpdateForm.pkg,proxyUser:this.addOrUpdateForm.proxyUser});l===0?(i({message:"\u64CD\u4F5C\u6210\u529F",type:"success",duration:1500}),this.addOrUpdateVisible=!1,this.getDataList()):i.error(d||"\u64CD\u4F5C\u5931\u8D25")}catch{i.error("\u64CD\u4F5C\u5931\u8D25")}finally{this.submitLoading=!1}})},handleDelete(e){O.confirm("\u786E\u5B9A\u8981\u5220\u9664\u8BE5\u4EE3\u7406\u914D\u7F6E\u5417\uFF1F","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(async()=>{try{const{code:t,msg:l}=await E.post("/proxyInfo/delete",{id:e});t===0?(i({message:"\u5220\u9664\u6210\u529F",type:"success",duration:1500}),this.getDataList()):i.error(l||"\u5220\u9664\u5931\u8D25")}catch{i.error("\u5220\u9664\u5931\u8D25")}}).catch(()=>{})}}}),R={class:"mod-proxy__list"};function T(e,t,l,d,f,y){const s=n("el-input"),u=n("el-form-item"),m=n("el-button"),U=n("el-form"),g=n("el-table-column"),h=n("el-table"),c=n("el-pagination"),v=n("el-dialog"),V=$("loading");return C(),L("div",R,[a(U,{inline:!0,model:e.dataForm,onKeyup:t[4]||(t[4]=A(o=>e.getDataList(),["enter"]))},{default:r(()=>[a(u,null,{default:r(()=>[a(s,{modelValue:e.dataForm.pkg,"onUpdate:modelValue":t[0]||(t[0]=o=>e.dataForm.pkg=o),placeholder:"\u5305\u540D",clearable:""},null,8,["modelValue"])]),_:1}),a(u,null,{default:r(()=>[a(s,{modelValue:e.dataForm.proxyUser,"onUpdate:modelValue":t[1]||(t[1]=o=>e.dataForm.proxyUser=o),placeholder:"\u4EE3\u7406\u7528\u6237",clearable:""},null,8,["modelValue"])]),_:1}),a(u,null,{default:r(()=>[a(m,{onClick:t[2]||(t[2]=o=>e.getDataList())},{default:r(()=>[p(F(e.$t("query")),1)]),_:1})]),_:1}),a(u,null,{default:r(()=>[a(m,{type:"primary",onClick:t[3]||(t[3]=o=>e.openAddOrUpdateDialog())},{default:r(()=>[p(F(e.$t("add")),1)]),_:1})]),_:1})]),_:1},8,["model"]),B((C(),_(h,{data:e.dataList,border:"",onSortChange:e.dataListSortChangeHandle,"table-layout":"auto",style:{width:"100%"}},{default:r(()=>[a(g,{prop:"id",label:"ID","header-align":"center",align:"center",width:"80px"}),a(g,{prop:"pkg",label:"\u5305\u540D","header-align":"center",align:"center","show-overflow-tooltip":""}),a(g,{prop:"proxyUser",label:"\u4EE3\u7406\u7528\u6237","header-align":"center",align:"center","show-overflow-tooltip":""}),a(g,{prop:"created",label:"\u521B\u5EFA\u65F6\u95F4","header-align":"center",align:"center",sortable:"custom"},{default:r(o=>[p(F(e.formatDateTime(o.row.created)),1)]),_:1}),a(g,{label:"\u64CD\u4F5C","header-align":"center",align:"center",width:"150px",fixed:"right"},{default:r(o=>[a(m,{type:"danger",size:"small",onClick:H=>e.handleDelete(o.row.id)},{default:r(()=>t[10]||(t[10]=[p("\u5220\u9664")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onSortChange"])),[[V,e.dataListLoading]]),a(c,{"current-page":e.page,"page-sizes":[10,20,50,100],"page-size":e.limit,total:e.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:e.pageSizeChangeHandle,onCurrentChange:e.pageCurrentChangeHandle},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"]),a(v,{title:"\u65B0\u589E\u4EE3\u7406",modelValue:e.addOrUpdateVisible,"onUpdate:modelValue":t[9]||(t[9]=o=>e.addOrUpdateVisible=o),width:"500px","close-on-click-modal":!1},{footer:r(()=>[a(m,{onClick:t[7]||(t[7]=o=>e.addOrUpdateVisible=!1)},{default:r(()=>t[11]||(t[11]=[p("\u53D6\u6D88")])),_:1}),a(m,{type:"primary",onClick:t[8]||(t[8]=o=>e.dataFormSubmit()),loading:e.submitLoading},{default:r(()=>t[12]||(t[12]=[p("\u786E\u5B9A")])),_:1},8,["loading"])]),default:r(()=>[a(U,{model:e.addOrUpdateForm,rules:e.dataRule,ref:"dataFormRef","label-width":"100px"},{default:r(()=>[a(u,{label:"\u5305\u540D",prop:"pkg"},{default:r(()=>[a(s,{modelValue:e.addOrUpdateForm.pkg,"onUpdate:modelValue":t[5]||(t[5]=o=>e.addOrUpdateForm.pkg=o),placeholder:"\u8BF7\u8F93\u5165\u5305\u540D"},null,8,["modelValue"])]),_:1}),a(u,{label:"\u4EE3\u7406\u7528\u6237",prop:"proxyUser"},{default:r(()=>[a(s,{modelValue:e.addOrUpdateForm.proxyUser,"onUpdate:modelValue":t[6]||(t[6]=o=>e.addOrUpdateForm.proxyUser=o),placeholder:"\u8BF7\u8F93\u5165\u4EE3\u7406\u7528\u6237"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}var j=z(I,[["render",T],["__scopeId","data-v-30934967"]]);export{j as default};
