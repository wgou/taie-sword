import{d as I,a as $,r as s,t as r,u as n,G as o,F as l,I as p,A as c,J as F,K as h}from"./vlib.73c86f1d.js";import{_ as C,j as D,b as u}from"./index.bc4fd47c.js";import"./monacoeditor.d62c48b5.js";import"./lodash.58534d7e.js";import"./lib.e5e0e84e.js";const _=I({setup(){return $({visible:!1,dataForm:{id:"",datasourceId:"",datasourceList:[],tableInfoList:[],tableInfo:{tableName:""},showTableSelect:!1}})},computed:{dataRule(){return{datasourceId:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],tableInfo:[{validator:(t,v,d)=>{if(!this.dataForm.tableInfo.tableName)return d(new Error("\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A"));d()},trigger:"blur"}]}}},created(){this.dataFormSubmitHandle=D(this.dataFormSubmitHandle)},methods:{init(){this.visible=!0,this.$nextTick(()=>{this.$refs.dataFormRef.resetFields(),this.getDataSource()})},getDataSource(){u.get("/devtools/datasource/list").then(e=>{if(e.code!==0)return this.$message.error(e.msg);this.dataForm.datasourceList=e.data})},getTableInfoList(){this.dataForm.showTableSelect=!1,this.dataForm.tableInfo.tableName="",u.get("/devtools/datasource/table/list/"+this.dataForm.datasourceId).then(e=>{if(e.code!==0)return this.$message.error(e.msg);this.dataForm.tableInfoList=e.data,this.dataForm.showTableSelect=!0})},dataFormSubmitHandle(){this.$refs.dataFormRef.validate(e=>{if(!e)return!1;(this.dataForm.id?u.put:u.post)("/devtools/datasource/table",this.dataForm.tableInfo).then(t=>{if(t.code!==0)return this.$message.error(t.msg);this.$message({message:this.$t("prompt.success"),type:"success",duration:500,onClose:()=>{this.visible=!1,this.$emit("refreshDataList")}})})})}}});function w(e,t,v,d,S,V){const i=s("el-option"),m=s("el-select"),f=s("el-form-item"),g=s("el-form"),b=s("el-button"),E=s("el-dialog");return r(),n(E,{modelValue:e.visible,"onUpdate:modelValue":t[3]||(t[3]=a=>e.visible=a),title:"\u5BFC\u5165\u6570\u636E\u5E93\u8868","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:o(()=>[l(b,{onClick:t[2]||(t[2]=a=>e.visible=!1)},{default:o(()=>t[4]||(t[4]=[p("\u53D6\u6D88")])),_:1}),l(b,{type:"primary",onClick:e.dataFormSubmitHandle},{default:o(()=>t[5]||(t[5]=[p("\u786E\u5B9A")])),_:1},8,["onClick"])]),default:o(()=>[l(g,{model:e.dataForm,rules:e.dataRule,ref:"dataFormRef","label-width":"120px"},{default:o(()=>[l(f,{label:"\u6570\u636E\u6E90",prop:"datasourceId"},{default:o(()=>[l(m,{modelValue:e.dataForm.datasourceId,"onUpdate:modelValue":t[0]||(t[0]=a=>e.dataForm.datasourceId=a),onChange:e.getTableInfoList,style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u6570\u636E\u6E90"},{default:o(()=>[l(i,{label:"\u9ED8\u8BA4\u6570\u636E\u6E90",value:"0"}),(r(!0),c(h,null,F(e.dataForm.datasourceList,a=>(r(),n(i,{key:a.id,label:a.connName,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),_:1}),l(f,{label:"\u9009\u62E9\u8868",prop:"tableInfo"},{default:o(()=>[l(m,{modelValue:e.dataForm.tableInfo,"onUpdate:modelValue":t[1]||(t[1]=a=>e.dataForm.tableInfo=a),"value-key":"tableName",disabled:!e.dataForm.showTableSelect,style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u8868\u540D"},{default:o(()=>[(r(!0),c(h,null,F(e.dataForm.tableInfoList,a=>(r(),n(i,{key:a.tableName,label:a.tableName,value:a},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}var N=C(_,[["render",w],["__file","/Users/luochen/project17/taie-sword/taie-admin-vue/src/views/devtools/generator-import.vue"]]);export{N as default};
