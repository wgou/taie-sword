import{S as C}from"./lib.aa75605a.js";import{_ as D,b as m}from"./index.d126106f.js";import{d as F,a as L,r as d,t as s,u as n,F as o,E as l,H as x,B as y,A as c,I as f,J as v}from"./vlib.0bb5c6cc.js";import"./lodash.8cc0d8b0.js";import"./monacoeditor.d62c48b5.js";const w=F({setup(){return L({visible:!1,loading:!1,typeList:[],dictList:[],queryList:[{label:"=",value:"="},{label:"!=",value:"!="},{label:">",value:">"},{label:">=",value:">="},{label:"<",value:"<"},{label:"<=",value:"<="},{label:"like",value:"like"},{label:"left like",value:"left like"},{label:"right like",value:"right like"}],formTypeList:[{label:"\u5355\u884C\u6587\u672C",value:"text"},{label:"\u591A\u884C\u6587\u672C",value:"textarea"},{label:"\u5BCC\u6587\u672C\u7F16\u8F91\u5668",value:"editor"},{label:"\u4E0B\u62C9\u6846",value:"select"},{label:"\u5355\u9009\u6309\u94AE",value:"radio"},{label:"\u590D\u9009\u6846",value:"checkbox"},{label:"\u65E5\u671F",value:"date"},{label:"\u65E5\u671F\u65F6\u95F4",value:"datetime"}],tableId:"",tableData:[]})},beforeUnmount(){this.sortable&&this.sortable.destroy()},methods:{init(t){this.visible=!0,this.$nextTick(()=>{this.tableId=t,this.getTable(t),this.getAttrTypeList(),this.getDictList(),this.rowDrop()})},rowDrop(){this.$nextTick(()=>{const t=this.$refs.xTable;this.sortable=C.create(t.$el.querySelector(".body--wrapper>.vxe-table--body tbody"),{handle:".drag-btn",onEnd:u=>{const{newIndex:g,oldIndex:_}=u,V=this.tableData.splice(_,1)[0];this.tableData.splice(g,0,V)}})})},getTable(t){m.get("/devtools/table/"+t).then(u=>{if(u.code!==0)return this.$message.error(u.msg);this.tableData=u.data.fields})},getAttrTypeList(){m.get("/devtools/fieldtype/list").then(t=>{if(t.code!==0)return this.$message.error(t.msg);this.typeList=[],t.data.forEach(u=>this.typeList.push({label:u,value:u})),this.typeList.push({label:"Object",value:"Object"})})},getDictList(){m.get("/devtools/dict").then(t=>{if(t.code!==0)return this.$message.error(t.msg);this.dictList=[],this.dictList.push({label:"",value:""}),t.data.forEach(u=>this.dictList.push({label:u.dictType,value:u.dictType}))})},updateHandle(){m.put("/devtools/table/field/"+this.tableId,this.tableData).then(t=>{if(t.code!==0)return this.$message.error(t.msg);this.$message({message:this.$t("prompt.success"),type:"success",duration:500,onClose:()=>{this.visible=!1,this.$emit("refreshDataList")}})})}}});function U(t,u,g,_,V,$){const i=d("vxe-column"),k=d("el-tooltip"),r=d("vxe-option"),p=d("vxe-select"),h=d("vxe-colgroup"),b=d("vxe-checkbox"),E=d("vxe-table"),B=d("el-button"),T=d("el-dialog");return s(),n(T,{modelValue:t.visible,"onUpdate:modelValue":u[2]||(u[2]=a=>t.visible=a),title:"\u7F16\u8F91","close-on-click-modal":!1,"close-on-press-escape":!1,fullscreen:!0},{footer:o(()=>[l(B,{onClick:u[0]||(u[0]=a=>t.visible=!1)},{default:o(()=>u[5]||(u[5]=[x("\u53D6\u6D88")])),_:1}),l(B,{type:"primary",onClick:u[1]||(u[1]=a=>t.updateHandle())},{default:o(()=>u[6]||(u[6]=[x("\u4FDD\u5B58")])),_:1})]),default:o(()=>[l(E,{border:"","row-key":"",ref:"xTable",class:"sortable-row-gen",size:"small",data:t.tableData,"checkbox-config":{checkStrictly:!0},"edit-config":{trigger:"click",mode:"cell"}},{default:o(()=>[l(i,{type:"seq",width:"35"}),l(i,{width:"34",title:"\u62D6\u52A8"},{default:o(()=>[u[3]||(u[3]=y("span",{class:"drag-btn"},[y("i",{class:"vxe-icon--menu"})],-1))]),header:o(()=>[l(k,{class:"item",effect:"dark",content:"\u6309\u4F4F\u540E\u53EF\u4EE5\u4E0A\u4E0B\u62D6\u52A8\u6392\u5E8F",placement:"top-start"},{default:o(()=>u[4]||(u[4]=[y("i",{class:"vxe-icon--question"},null,-1)])),_:1})]),_:1}),l(h,{title:"\u5B57\u6BB5",align:"center"},{default:o(()=>[l(i,{field:"columnName",width:"140",title:"\u5B57\u6BB5\u540D"}),l(i,{field:"attrName",width:"140",title:"\u5C5E\u6027\u540D","edit-render":{name:"input"}}),l(i,{field:"columnType",width:"140",title:"\u5B57\u6BB5\u7C7B\u578B"}),l(i,{field:"attrType",width:"140",title:"\u5C5E\u6027\u7C7B\u578B"},{default:o(({row:a})=>[l(p,{modelValue:a.attrType,"onUpdate:modelValue":e=>a.attrType=e},{default:o(()=>[(s(!0),c(v,null,f(t.typeList,e=>(s(),n(r,{key:e.value,value:e.value,label:e.label},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),l(i,{field:"columnComment",width:"140",title:"\u5B57\u6BB5\u8BF4\u660E","edit-render":{name:"input"}})]),_:1}),l(h,{title:"\u5217\u8868",align:"center"},{default:o(()=>[l(i,{field:"list",width:"75",title:"\u5217\u8868"},{default:o(({row:a})=>[l(b,{modelValue:a.list,"onUpdate:modelValue":e=>a.list=e},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(i,{field:"query",width:"75",title:"\u67E5\u8BE2"},{default:o(({row:a})=>[l(b,{modelValue:a.query,"onUpdate:modelValue":e=>a.query=e},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(i,{field:"queryType",width:"140",title:"\u67E5\u8BE2\u65B9\u5F0F"},{default:o(({row:a})=>[l(p,{modelValue:a.queryType,"onUpdate:modelValue":e=>a.queryType=e},{default:o(()=>[(s(!0),c(v,null,f(t.queryList,e=>(s(),n(r,{key:e.value,value:e.value,label:e.label},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1}),l(h,{title:"\u8868\u5355",align:"center"},{default:o(()=>[l(i,{field:"form",width:"70",title:"\u8868\u5355"},{default:o(({row:a})=>[l(b,{modelValue:a.form,"onUpdate:modelValue":e=>a.form=e},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(i,{field:"required",width:"70",title:"\u5FC5\u586B"},{default:o(({row:a})=>[l(b,{modelValue:a.required,"onUpdate:modelValue":e=>a.required=e},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(i,{field:"formType",width:"140",title:"\u8868\u5355\u7C7B\u578B"},{default:o(({row:a})=>[l(p,{modelValue:a.formType,"onUpdate:modelValue":e=>a.formType=e},{default:o(()=>[(s(!0),c(v,null,f(t.formTypeList,e=>(s(),n(r,{key:e.value,value:e.value,label:e.label},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),l(i,{field:"dictName",width:"140",title:"\u5B57\u5178\u540D\u79F0"},{default:o(({row:a})=>[l(p,{modelValue:a.dictName,"onUpdate:modelValue":e=>a.dictName=e},{default:o(()=>[(s(!0),c(v,null,f(t.dictList,e=>(s(),n(r,{key:e.value,value:e.value,label:e.label},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1},8,["data"])]),_:1},8,["modelValue"])}var H=D(w,[["render",U]]);export{H as default};
